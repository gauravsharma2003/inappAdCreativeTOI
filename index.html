<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Portrait Ad</title>
  <link href="https://fonts.googleapis.com/css2?family=Rethink+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --font-family: "Rethink Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      --bg: #ffffff;
      --video-placeholder: #eeeeee;
      --text: #111111;
      --muted: #6b7280;
      --cta-bg: #000000;
      --cta-text: #ffffff;
      --radius: 16px;
      --spacing: 14px;
    }

    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      font-family: var(--font-family);
      color: var(--text);
    }
    body {
      min-height: 100vh;
      display: grid;
      place-items: center;
    }

    /* 9:16 portrait container */
    .ad-container {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      padding: var(--spacing);
      display: grid;
      place-items: center;
    }

    .ad-frame {
      width: 100%;
      aspect-ratio: 9 / 16;
      background: var(--bg);
      border-radius: var(--radius);
      /* box-shadow: 0 1px 2px rgba(0,0,0,0.06), 0 8px 24px rgba(0,0,0,0.08); */
      overflow: hidden;
      display: grid;
      grid-template-rows: auto auto auto auto auto;
      align-items: start;
      justify-items: center;
      padding: calc(var(--spacing) * 1.1);
      gap: calc(var(--spacing) * 1.1);
    }

    /* Top: square video area */
    .video-wrap {
      width: 100%;
      aspect-ratio: 1 / 1;             /* square */
      position: relative;
      border-radius: calc(var(--radius) * 0.75);
      /* border: 1.5px solid #e5e7eb; light grey border */
      overflow: hidden;
      background: var(--video-placeholder);
      isolation: isolate;
    }

    .video-placeholder {
      position: absolute;
      inset: 0;
      background: var(--video-placeholder);
      transition: opacity 250ms ease;
      z-index: 1;
    }

    .video-wrap video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 250ms ease;
    }

    .video-wrap.is-loaded .video-placeholder { opacity: 0; }
    .video-wrap.is-loaded video { opacity: 1; }

    /* Headline */
    .headline {
      font-size: clamp(14px, 4.5vw, 18px);
      font-weight: 600;
      line-height: 1.125;
      letter-spacing: 0.2px;
      margin: 0;
      text-align: center;
    }

    /* Middle logo */
    .logo {
      width: clamp(72px, 30%, 130px);
      max-width: 130px;
      height: auto;
      object-fit: contain;
      justify-self: center;
      filter: none;
    }

    /* Game title below logo */
    .game-title {
      margin: 0;
      text-align: center;
      font-size: clamp(16px, 7vw, 28px);
      font-weight: 700;
      letter-spacing: 0.2px;
      line-height: 1.15;
      color: var(--text);
    }

    /* CTA - island/pill shape */
    .cta {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-height: 44px;
      padding: 10px 20px;
      background: var(--cta-bg);
      color: var(--cta-text);
      text-decoration: none;
      font-weight: 700;
      border-radius: 9999px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.22), 0 2px 6px rgba(0,0,0,0.18);
      transition: transform 120ms ease, box-shadow 120ms ease;
      will-change: transform;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      width: 100%;
      justify-self: stretch;
    }

    .cta:active { transform: translateY(1px) scale(0.98); }
    .cta:focus-visible {
      outline: 2px solid #000;
      outline-offset: 2px;
    }

    .cta .play-icon {
      width: 0;
      height: 0;
      border-left: 8px solid var(--cta-text);
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
    }

    /* Equal spacing between rows; no spacer needed */

    @media (max-width: 360px) {
      .ad-frame { padding: var(--spacing); }
      .headline { font-size: 16px; }
    }
  </style>
</head>
<body>
  <div class="ad-container" role="region" aria-label="Game Ad">
    <section class="ad-frame" aria-describedby="headline gameTitle">
      <!-- Top: square video -->
      <div class="video-wrap" id="videoWrap">
        <div class="video-placeholder" aria-hidden="true"></div>
        <video id="adVideo" playsinline muted autoplay preload="metadata">
          <source id="videoSource" src="" type="video/mp4" />
        </video>
      </div>

      <!-- Headline -->
      <h1 class="headline" id="headline"></h1>

      <!-- Middle logo -->
      <img class="logo" id="logo" alt="" />

      <!-- Game title below the logo -->
      <h2 class="game-title" id="gameTitle"></h2>

      <!-- CTA -->
      <a class="cta" id="cta" href="#" target="_blank" rel="noopener">
        <!-- <span class="play-icon" aria-hidden="true"></span> -->
        <span id="ctaText"></span>
      </a>
    </section>
  </div>

  <script>
    // Editable JSON content for the ad
    const content = {
      gameName: "Connect",
      headline: "Connect Start to end - its that simple",
      toGameText: "Play the game",
      ctaText: "Play Now",
      ctaUrl: "https://timesofindia.indiatimes.com/games/connect/today",
      logoUrl: "https://static.toiimg.com/photo/122115391.cms",
      // Add your MP4 video URL below. The light grey placeholder shows until this can play.
      videoUrl: "./videoConnect.mp4" // e.g., "https://cdn.example.com/your-video.mp4"
    };

    // Populate UI
    (function initAd(cfg) {
      const headlineEl = document.getElementById("headline");
      const logoEl = document.getElementById("logo");
      const gameTitleEl = document.getElementById("gameTitle");
      const ctaEl = document.getElementById("cta");
      const ctaTextEl = document.getElementById("ctaText");
      const videoWrapEl = document.getElementById("videoWrap");
      const videoEl = document.getElementById("adVideo");
      const videoSourceEl = document.getElementById("videoSource");

      headlineEl.textContent = cfg.headline || "";
      ctaTextEl.textContent = cfg.ctaText || "Play Now";
      ctaEl.href = cfg.ctaUrl || "#";
      ctaEl.setAttribute("aria-label", (cfg.ctaText || "Play Now") + (cfg.gameName ? (" â€” " + cfg.gameName) : ""));

      // Logo
      if (cfg.logoUrl) {
        logoEl.src = cfg.logoUrl;
        logoEl.alt = cfg.gameName ? (cfg.gameName + " Logo") : "Game Logo";
      }

      // Game title below logo
      if (cfg.gameName && String(cfg.gameName).trim()) {
        gameTitleEl.textContent = String(cfg.gameName).trim();
      }

      // Video setup with graceful loading
      if (cfg.videoUrl && typeof cfg.videoUrl === "string" && cfg.videoUrl.trim() !== "") {
        videoSourceEl.src = cfg.videoUrl.trim();
        videoEl.load();

        let playCount = 0;
        const onReady = () => {
          videoWrapEl.classList.add("is-loaded");
          // Try to autoplay (muted) on mobile
          const playAttempt = videoEl.play();
          if (playAttempt && typeof playAttempt.catch === "function") {
            playAttempt.catch(() => {
              // If autoplay fails, keep placeholder visible until user taps CTA
            });
          }
        };

        // Count plays and stop after 3
        videoEl.addEventListener("ended", () => {
          playCount += 1;
          if (playCount < 3) {
            // restart from beginning for the next loop
            videoEl.currentTime = 0;
            const p = videoEl.play();
            if (p && typeof p.catch === "function") p.catch(() => {});
          } else {
            // Stop on the last frame (end)
            videoEl.pause();
            videoEl.currentTime = Math.max(0, (videoEl.duration || 0) - 0.05);
          }
        });

        // Mark as loaded when ready to play
        videoEl.addEventListener("canplay", onReady, { once: true });
        // Fallback: if metadata loads but 'canplay' is delayed, still reveal after a short timeout
        let fallbackTimer = setTimeout(() => {
          videoWrapEl.classList.add("is-loaded");
        }, 2500);
        videoEl.addEventListener("canplay", () => clearTimeout(fallbackTimer), { once: true });
      } else {
        // No video provided: keep placeholder visible and video hidden
        videoEl.style.display = "none";
      }
    })(content);
  </script>
</body>
</html>